"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.obtainScope=exports.cloudAssemblyBuildSpecDir=exports.embeddedAsmPath=exports.pipelineSynth=exports.assemblyBuilderOf=exports.appOf=void 0;const path=require("path"),constructs_1=require("constructs"),core_1=require("../../../core");function appOf(construct){const root=constructs_1.Node.of(construct).root;if(!core_1.App.isApp(root))throw new Error(`Construct must be created under an App, but is not: ${constructs_1.Node.of(construct).path}`);return root}exports.appOf=appOf;function assemblyBuilderOf(stage){return stage._assemblyBuilder}exports.assemblyBuilderOf=assemblyBuilderOf;function pipelineSynth(stage){return stage.synth({validateOnSynthesis:!0})}exports.pipelineSynth=pipelineSynth;function embeddedAsmPath(scope){const appAsmRoot=assemblyBuilderOf(appOf(scope)).outdir,stage=core_1.Stage.of(scope)??appOf(scope),stageAsmRoot=assemblyBuilderOf(stage).outdir;return path.relative(appAsmRoot,stageAsmRoot)||"."}exports.embeddedAsmPath=embeddedAsmPath;function cloudAssemblyBuildSpecDir(scope){return assemblyBuilderOf(appOf(scope)).outdir}exports.cloudAssemblyBuildSpecDir=cloudAssemblyBuildSpecDir;function obtainScope(parent,id){const existing=constructs_1.Node.of(parent).tryFindChild(id);return existing||new constructs_1.Construct(parent,id)}exports.obtainScope=obtainScope;
