"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OpenSearchAccessPolicy=void 0;const iam=require("../../aws-iam"),cdk=require("../../core"),cr=require("../../custom-resources");class OpenSearchAccessPolicy extends cr.AwsCustomResource{constructor(scope,id,props){super(scope,id,{resourceType:"Custom::OpenSearchAccessPolicy",onUpdate:{action:"updateDomainConfig",service:"OpenSearch",parameters:{DomainName:props.domainName,AccessPolicies:cdk.Lazy.string({produce:()=>JSON.stringify(new iam.PolicyDocument({statements:this.accessPolicyStatements}).toJSON())})},outputPaths:["DomainConfig.AccessPolicies"],physicalResourceId:cr.PhysicalResourceId.of(`${props.domainName}AccessPolicy`)},policy:cr.AwsCustomResourcePolicy.fromStatements([new iam.PolicyStatement({actions:["es:UpdateDomainConfig"],resources:[props.domainArn]})])}),this.accessPolicyStatements=[],this.addAccessPolicies(...props.accessPolicies)}addAccessPolicies(...accessPolicyStatements){this.accessPolicyStatements.push(...accessPolicyStatements)}}exports.OpenSearchAccessPolicy=OpenSearchAccessPolicy;
